<Window
    x:Class="Resource_Manager.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Resource_Manager"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="{Binding file.barFileName, StringFormat='{}Resource Manager v0.6.0 - {0}', FallbackValue='Resource Manager v0.6.0'}"
    Width="1177"
    Height="700"
    FontFamily="{StaticResource Trajan Pro}"
    FontSize="14"
    UseLayoutRounding="True"
    WindowStartupLocation="CenterScreen"

    mc:Ignorable="d" Loaded="Window_Loaded">
    <Window.Resources>
        <ControlTemplate x:Key="Spinner">
            <Grid>
                <Rectangle VerticalAlignment="Center" Width="16" Height="16" RenderTransformOrigin="0.5,0.5">
                    <Rectangle.Fill>
                        <ImageBrush ImageSource="/resources/loadingspinner.png" />
                    </Rectangle.Fill>
                    <Rectangle.RenderTransform>
                        <RotateTransform />
                    </Rectangle.RenderTransform>
                    <Rectangle.Triggers>
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetProperty="(Rectangle.RenderTransform).(RotateTransform.Angle)" To="360" Duration="0:0:1" RepeatBehavior="Forever" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Rectangle.Triggers>
                </Rectangle>
            </Grid>
        </ControlTemplate>
        <local:MathConverter x:Key="MathConverter" />
        <local:HighlightingDefinitionConverter x:Key="HighlightingDefinitionConverter" />
        <local:RunEnabledColorConverter x:Key="RunEnabledColorConverter" />
        <local:PauseEnabledColorConverter x:Key="PauseEnabledColorConverter" />
        <local:StopEnabledColorConverter x:Key="StopEnabledColorConverter" />
        <Image x:Key="hotFiles" x:Shared="False">
            <Image.Source>
                <DrawingImage>
                    <DrawingImage.Drawing>


                        <DrawingGroup>
                            <DrawingGroup.Children>
                                <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M13.6611,6.7681C13.7431,7.0121,15.1221,12.5841,10.9661,14.6621L10.1031,14.7671 5.3771,14.7671C3.9621,14.7671 2.9871,13.0721 2.7321,12.4171 2.1981,11.0651 2.1961,9.7121 2.7241,8.2781 2.8561,7.9201 3.0701,7.4661 3.3091,6.9631 3.7951,5.9371 4.5301,4.3881 4.3951,3.6681L3.7811,0.4271 6.0911,2.7821C6.8471,3.5531 7.3191,4.5001 7.6151,5.4281 7.6281,5.0391 7.5651,4.6391 7.4271,4.2271 7.0841,3.1941 6.6691,2.4821 6.6621,2.4751L5.6621,0.7681 7.6621,0.873100000000001C10.9091,2.4971,11.4231,5.4331,11.5031,6.5061L12.6611,4.7681 13.6611,6.7681" />
                                <GeometryDrawing Brush="#FFE41400" Geometry="F1M12.6572,7.127C12.6572,8.841 10.9442,10.556 10.9442,10.556 9.2282,12.272 10.9442,13.984 10.9442,13.984 14.3722,12.272 12.6572,7.127 12.6572,7.127 M9.2282,10.557C9.2282,10.557 10.9442,8.842 10.9442,7.128 10.9442,7.128 10.9442,3.699 7.5152,1.985 7.5152,1.985 10.9442,5.415 7.5152,8.841 7.5152,7.097 7.0552,4.978 5.8012,3.698 6.0712,5.125 4.5452,7.6 4.0862,8.841 3.6502,10.023 3.6332,11.123 4.0862,12.272 4.3022,12.82 5.0572,13.984 5.8012,13.984L7.5152,13.984C6.1982,13.982 4.7732,11.589 5.8012,10.556 5.4122,10.947 6.3832,12.019 6.6572,12.272 7.1532,12.724 8.4972,13.984 9.2272,13.984L10.9432,13.984C10.9442,13.984,7.5162,12.272,9.2282,10.557" />
                            </DrawingGroup.Children>
                        </DrawingGroup>

                    </DrawingImage.Drawing>
                </DrawingImage>
            </Image.Source>
        </Image>

        <Style x:Key="GridSplitterVerticalGripStyle" TargetType="{x:Type GridSplitter}">
            <Setter Property="VerticalAlignment" Value="Stretch" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Cursor" Value="SizeWE" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GridSplitter}">
                        <Border
                            Width="{TemplateBinding Width}"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                            <Border
                                Width="4"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Background="White"
                                BorderBrush="#A0A0A0"
                                BorderThickness="1,0" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style
            x:Key="VerticalGridSplitter"
            BasedOn="{StaticResource GridSplitterVerticalGripStyle}"
            TargetType="{x:Type GridSplitter}">

            <Setter Property="Width" Value="6" />
            <Setter Property="Margin" Value="15,0" />
            <Setter Property="VerticalAlignment" Value="Stretch" />
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>
    </Window.Resources>
        <Grid>

           

                <Grid.ColumnDefinitions>
                    <ColumnDefinition x:Name="cdGrid" Width="775" />
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition />
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="auto" />
                </Grid.RowDefinitions>



                <Grid
            x:Name="gPreview"
                                    PreviewMouseMove="ImagePreview_MouseMove"
            Grid.Row="1"
            Grid.RowSpan="2"
            Grid.Column="2"
            Margin="0,0,15,15" Cursor="SizeAll">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <TextBlock
                Grid.Row="0"
                FontSize="14"
                Text="{Binding ElementName=files, Path=SelectedItem.fileNameWithoutPath, StringFormat='File Name: {0}'}"
                TextTrimming="CharacterEllipsis"
                ToolTip="{Binding ElementName=files, Path=SelectedItem.FileNameWithRoot}" />
                    <TextBlock
                Grid.Row="1"
                FontSize="14"
                Text="{Binding ElementName=files, Path=SelectedItem.fileFormat, StringFormat='File Format: {0}'}" />
                    <TextBlock
                Grid.Row="2"
                FontSize="14"
                Text="{Binding file.PreviewDdt.DdtInfo, StringFormat='Image Format: {0}'}" />
                    <Grid
                x:Name="ImageViewer"
Background="White"
                Grid.Row="3"
                Visibility="Collapsed">
                        <ScrollViewer
                    VerticalScrollBarVisibility="Hidden"
                    HorizontalScrollBarVisibility="Hidden"
                    VirtualizingPanel.ScrollUnit="Pixel">


                            <Image
                        x:Name="ImagePreview"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        MouseWheel="ImageViewer_MouseWheel"
                        RenderOptions.BitmapScalingMode="HighQuality"

                        RenderTransformOrigin="0.5,0.5">
                                <Image.LayoutTransform>
                                    <TransformGroup>
                                        <ScaleTransform />

                                    </TransformGroup>
                                </Image.LayoutTransform>

                                <Image.RenderTransform>
                                    <TransformGroup>
                                        <TranslateTransform></TranslateTransform>
                                    </TransformGroup>
                                </Image.RenderTransform>
                            </Image>



                        </ScrollViewer>
                        <TextBlock
                    Margin="25"
                    Padding="2,4,2,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Background="#99FFFFFF"
                    FlowDirection="RightToLeft"
                    MouseDown="TextBlock_MouseDown"
                    Text="{Binding ZoomValue, StringFormat='Current Zoom: {0}%'}"
                    TextAlignment="Center" />
                    </Grid>
                    <avalonEdit:TextEditor
                x:Name="XMLViewer"
                Grid.Row="3"
                FontFamily="Consolas"
                FontSize="10pt"
                IsReadOnly="True"
                ShowLineNumbers="True"
                SyntaxHighlighting="{Binding file.Preview.SyntaxHighlighting, Converter={StaticResource HighlightingDefinitionConverter}}"
                VirtualizingPanel.ScrollUnit="Pixel"
                Visibility="Collapsed" />

                </Grid>

        <ListView
            Name="files"
            Grid.Row="1"
            AlternationCount="2"
            ItemsSource="{Binding file.SourceCollection}"
            ScrollViewer.HorizontalScrollBarVisibility="Visible"
            ScrollViewer.VerticalScrollBarVisibility="Visible"
            SelectionChanged="files_SelectionChanged"
            VirtualizingPanel.IsVirtualizingWhenGrouping="True"
            VirtualizingPanel.ScrollUnit="Pixel">
            <ListView.Resources>
                <ContextMenu FontFamily="{StaticResource Trajan Pro}"
            FontSize="16" x:Key="ItemContextMenu">
                    <MenuItem
                    Click="extractMenuItem"
                    Header="Extract Selected..."
                    Tag="Selected">
                        <MenuItem.Icon>
                            <Viewbox
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            Width="16"
                            Height="16">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,0L16,12 15.949,12C15.697,14.244 13.81,16 11.5,16 10.638,16 9.841,15.744 9.156,15.323L7.716,15.751C7.16,15.916 6.583,16 6.001,16 4.623,16 3.275,15.519 2.207,14.649 0.965999999999999,13.636 0.193,12.199 0.0310000000000006,10.604 -0.129999999999999,9.009 0.339,7.448 1.353,6.206 1.552,5.963 1.771,5.743 2,5.537L2,0z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M4,4L6.003,4C5.803,4 5.602,4.01 5.397,4.03 4.913,4.079 4.447,4.191 4,4.348z M6.003,4L14,4 14,7.785C13.259,7.282 12.396,7 11.5,7 11.404,7 11.312,7.017 11.218,7.023L10.987,6.676C10.651,6.168 10.25,5.723 9.795,5.352 8.71,4.467 7.399,4 6.003,4 M14,3L4,3 4,2 14,2z M7.214,8.179C6.768,8.663 6.121,8.319 5.677,8.024 5.209,7.712 5.597,6.991 6.062,7.185 6.294,6.855 6.785,6.646 7.144,6.819 7.634,7.054 7.526,7.839 7.214,8.179 M5.077,12.138C4.703,12.167 4.277,11.943 4.21,11.589 4.118,11.108 4.767,10.725 5.193,10.747 5.801,10.778 5.897,11.434 5.918,11.919 5.94,12.431 5.186,12.579 5.077,12.138 M3.722,10.044C3.477,10.385 2.951,10.076 3.108,9.735 2.869,9.553 2.727,9.182 2.865,8.919 3.054,8.561 3.635,8.663 3.88,8.905 4.228,9.25 3.954,9.722 3.722,10.044 M8.676,6.723C7.914,6.1 6.98,5.769 6.009,5.769 5.865,5.769 5.721,5.776 5.575,5.791 4.451,5.904 3.438,6.449 2.723,7.324 2.009,8.2 1.678,9.301 1.792,10.426 1.905,11.55 2.45,12.562 3.325,13.277 4.277,14.054 5.509,14.373 6.705,14.171 6.241,13.243 6.349,12.1 7.023,11.269 7.108,9.638 8.059,8.246 9.43,7.528 9.217,7.231 8.966,6.959 8.676,6.723" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M7.2172,12.8095C7.0892,12.3925 7.0002,11.9585 7.0002,11.4995 7.0002,11.4215 7.0192,11.3475 7.0232,11.2695 6.3482,12.1005 6.2412,13.2435 6.7042,14.1715 5.5092,14.3735 4.2762,14.0535 3.3252,13.2775 2.4502,12.5625 1.9052,11.5495 1.7912,10.4255 1.6782,9.3015 2.0092,8.1995 2.7232,7.3245 3.4382,6.4495 4.4512,5.9045 5.5752,5.7905 5.7202,5.7755 5.8652,5.7685 6.0092,5.7685 6.9802,5.7685 7.9142,6.0995 8.6762,6.7225 8.9662,6.9595 9.2172,7.2315 9.4292,7.5285 9.6612,7.4075 9.9012,7.3085 10.1542,7.2285 9.8832,6.8195 9.5532,6.4445 9.1622,6.1265 8.1262,5.2815 6.8242,4.8935 5.4982,5.0245 4.1692,5.1595 2.9722,5.8035 2.1272,6.8375 1.2822,7.8725 0.8912,9.1745 1.0262,10.5025 1.1602,11.8315 1.8042,13.0295 2.8392,13.8735 3.7432,14.6115 4.8622,14.9995 6.0012,14.9995 6.4792,14.9995 6.9612,14.9315 7.4322,14.7915L7.9852,14.6275 7.6202,14.1795C7.2982,13.7845,7.1772,13.2925,7.2172,12.8095 M14.0002,1.9995L4.0002,1.9995 4.0002,2.9995 14.0002,2.9995z M14.0002,3.9995L4.0002,3.9995 4.0002,4.3485C3.6522,4.4715,3.3182,4.6245,3.0002,4.8085L3.0002,0.999499999999999 15.0002,0.999499999999999 15.0002,8.7185C14.7602,8.4025,14.5692,8.2235,14.5692,8.2235L14.5382,8.1955C14.3702,8.0415,14.1862,7.9115,14.0002,7.7845z M4.2102,11.5895C4.2772,11.9435 4.7032,12.1675 5.0772,12.1375 5.1862,12.5785 5.9402,12.4315 5.9182,11.9195 5.8962,11.4345 5.8012,10.7785 5.1932,10.7475 4.7672,10.7255 4.1182,11.1075 4.2102,11.5895 M2.8652,8.9185C2.7272,9.1815 2.8692,9.5535 3.1082,9.7345 2.9502,10.0755 3.4772,10.3845 3.7222,10.0445 3.9542,9.7215 4.2282,9.2505 3.8802,8.9045 3.6352,8.6625 3.0532,8.5605 2.8652,8.9185 M7.2132,8.1785C6.7682,8.6635 6.1212,8.3195 5.6772,8.0245 5.2082,7.7125 5.5972,6.9905 6.0622,7.1845 6.2942,6.8555 6.7842,6.6465 7.1442,6.8185 7.6342,7.0535 7.5262,7.8395 7.2132,8.1785" />
                                                        <GeometryDrawing Brush="#FF329932" Geometry="F1M15,11.5C15,13.433 13.433,15 11.5,15 9.567,15 8,13.433 8,11.5 8,9.567 9.567,8 11.5,8 12.414,8 13.238,8.358 13.861,8.932L10.5,12.293 9.354,11.146 8.646,11.854 10.5,13.707 14.494,9.713C14.32,9.422,15,10.48,15,11.5" />
                                                        <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1M8.6635,11.8664L9.3595,11.1544 10.4855,12.2644 13.8315,8.9344C13.8315,8.9344,14.3955,9.5474,14.4615,9.6964L10.4855,13.6724z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Entry Details" Click="MenuItem_Click_2">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M14,6C14,7.909 13.121,9.659 11.587,10.804 11.214,11.082 11,11.461 11,11.843L11,13 11,14.414 9.414,16 6.586,16 5,14.414 5,12C5,11.523 4.786,11.081 4.428,10.814 2.583,9.447 1.69,7.182 2.098,4.901 2.521,2.539 4.377,0.623 6.717,0.134 7.143,0.0449999999999999 7.574,0 8,0 11.309,0 14,2.691 14,6" />
                                                        <GeometryDrawing Brush="#FF838383" Geometry="F1M6,13L10,13 10,12 6,12z M6,14L10,14 9,15 7,15z" />
                                                        <GeometryDrawing Brush="#FFFFCC00" Geometry="F1M6.9219,1.1128C4.9789,1.5188 3.4319,3.1238 3.0829,5.0778 2.7219,7.0928 3.5709,8.9348 5.0239,10.0118 5.6489,10.4758 5.9999,11.2218 5.9999,11.9998L7.4999,11.9998 7.4999,8.4488C6.3599,8.2168 5.4999,7.2068 5.4999,5.9998 5.4999,4.6218 6.6219,3.4998 7.9999,3.4998 9.3789,3.4998 10.4999,4.6218 10.4999,5.9998 10.4999,7.2068 9.6399,8.2168 8.4999,8.4488L8.4999,11.9998 9.9999,11.9998 9.9999,11.8428C9.9999,11.1028 10.3959,10.4458 10.9889,10.0018 12.2089,9.0918 12.9999,7.6388 12.9999,5.9998 12.9999,2.8868 10.1539,0.4378 6.9219,1.1128 M7.9999,7.4998C7.1729,7.4998 6.4999,6.8268 6.4999,5.9998 6.4999,5.1728 7.1729,4.4998 7.9999,4.4998 8.8269,4.4998 9.4999,5.1728 9.4999,5.9998 9.4999,6.8268 8.8269,7.4998 7.9999,7.4998" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="Copy Entry Path" Click="MenuItem_Click_6">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16">
                                <Canvas Width="24" Height="24">
                                    <Path Fill="Black" Data="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" />
                                </Canvas>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                </ContextMenu>
            </ListView.Resources>
            <ListView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.ContainerStyle>
                        <Style TargetType="{x:Type GroupItem}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <Expander IsExpanded="True">
                                            <Expander.Header>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock
                                                        VerticalAlignment="Bottom"
                                                        FontWeight="Bold"
                                                        Foreground="Gray"
                                                        Text="{Binding Name}" />
                                                    <TextBlock
                                                        Margin="8,0,0,0"
                                                        VerticalAlignment="Bottom"
                                                        Foreground="Green"
                                                        Text="{Binding ItemCount}" />
                                                    <TextBlock
                                                        VerticalAlignment="Bottom"
                                                        Foreground="Silver"
                                                        Text=" item(s)" />
                                                </StackPanel>
                                            </Expander.Header>
                                            <ItemsPresenter />
                                        </Expander>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </GroupStyle.ContainerStyle>
                </GroupStyle>
            </ListView.GroupStyle>

            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Margin" Value="0" />
                    <Setter Property="FontFamily" Value="Consolas" />
                    <Setter Property="FontSize" Value="10pt" />
                    <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsEnabled, ElementName=mainMenu}" Value="False">
                            <Setter Property="ContextMenu" Value="{x:Null}" />
                            <!-- Here is the 'override' content -->
                        </DataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=(ItemsControl.AlternationIndex)}" Value="0" />
                                <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False" />
                                <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="False" />

                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter Property="Background" Value="#0B000000" />
                            </MultiDataTrigger.Setters>


                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding IsLatestChange}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=(ItemsControl.AlternationIndex)}" Value="0" />

                                <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False" />
                                <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="False" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter Property="Background" Value="#2F008F00" />
                            </MultiDataTrigger.Setters>


                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding IsLatestChange}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=(ItemsControl.AlternationIndex)}" Value="1" />

                                <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False" />
                                <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="False" />
                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter Property="Background" Value="#1F008F00" />
                            </MultiDataTrigger.Setters>


                        </MultiDataTrigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView AllowsColumnReorder="False">
                    <GridViewColumn Width="50">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Rectangle
                                    x:Name="myImage"
                                    Width="16"
                                    Height="16" />
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding isCompressed}" Value="2">
                                        <Setter TargetName="myImage" Property="Fill">
                                            <Setter.Value>

                                                <DrawingBrush>
                                                    <DrawingBrush.Drawing>
                                                        <DrawingGroup>
                                                            <DrawingGroup.Children>
                                                                <GeometryDrawing Brush="Black" Geometry="M20 18H4V8H20M20 6H12L10 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.9 21.1 6 20 6M12.8 12C12.4 10.8 11.3 10 10 10C8.3 10 7 11.3 7 13S8.3 16 10 16C11.3 16 12.4 15.2 12.8 14H15V16H17V14H19V12H12.8M10 14C9.4 14 9 13.6 9 13C9 12.4 9.4 12 10 12S11 12.4 11 13 10.6 14 10 14Z" />
                                                            </DrawingGroup.Children>
                                                        </DrawingGroup>
                                                    </DrawingBrush.Drawing>
                                                </DrawingBrush>

                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding isCompressed}" Value="1">
                                        <Setter TargetName="myImage" Property="Fill">
                                            <Setter.Value>

                                                <DrawingBrush>
                                                    <DrawingBrush.Drawing>
                                                        <DrawingGroup>
                                                            <DrawingGroup.Children>
                                                                <GeometryDrawing Brush="Black" Geometry="M20 6H12L10 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.9 21.1 6 20 6M20 18H16V16H14V18H4V8H14V10H16V8H20V18M16 12V10H18V12H16M14 12H16V14H14V12M18 16H16V14H18V16Z" />
                                                            </DrawingGroup.Children>
                                                        </DrawingGroup>
                                                    </DrawingBrush.Drawing>
                                                </DrawingBrush>

                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding isCompressed}" Value="0">
                                        <Setter TargetName="myImage" Property="Fill" Value="Transparent" />
                                    </DataTrigger>
                                </DataTemplate.Triggers>


                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                        <GridViewColumn.Header>
                            <GridViewColumnHeader Click="files_Click" Tag="isCompressed">
                                <TextBlock>
                                <Viewbox
                                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                    Width="16"
                                    Height="16"
                                    Margin="1,0">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                               <GeometryDrawing Brush="Black" Geometry="M20 6H12L10 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.9 21.1 6 20 6M20 18H16V16H14V18H4V8H14V10H16V8H20V18M16 12V10H18V12H16M14 12H16V14H14V12M18 16H16V14H18V16Z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                                <Viewbox
                                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                    Width="16"
                                    Height="16"
                                    Margin="1,0">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                               <GeometryDrawing Brush="Black" Geometry="M20 18H4V8H20M20 6H12L10 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.9 21.1 6 20 6M12.8 12C12.4 10.8 11.3 10 10 10C8.3 10 7 11.3 7 13S8.3 16 10 16C11.3 16 12.4 15.2 12.8 14H15V16H17V14H19V12H12.8M10 14C9.4 14 9 13.6 9 13C9 12.4 9.4 12 10 12S11 12.4 11 13 10.6 14 10 14Z" />
                                                         </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>                                

                                </TextBlock>
                            </GridViewColumnHeader>
                        </GridViewColumn.Header>
                    </GridViewColumn>
                    <GridViewColumn x:Name="gvcFileName" Width="250">
                        <GridViewColumn.Header>
                            <GridViewColumnHeader
                                Click="files_Click"
                                Content="File Name"
                                Tag="FileNameWithRoot" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    Text="{Binding Path=FileNameWithRoot}"
                                    TextTrimming="CharacterEllipsis"
                                    ToolTip="{Binding Path=History}" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>


                    <GridViewColumn Width="160">
                        <GridViewColumn.Header>
                            <GridViewColumnHeader
                                Click="files_Click"
                                Content="File Size (bytes)"
                                Tag="FileSize2" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    Text="{Binding Path=FileSize2, StringFormat=N0}"
                                    TextAlignment="Right"
                                    TextTrimming="CharacterEllipsis" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>



                    <GridViewColumn Width="100">
                        <GridViewColumn.Header>
                            <GridViewColumnHeader
                                Click="files_Click"
                                Content="Hash"
                                Tag="Hash" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    Text="{Binding Path=Hash, StringFormat=X8}"
                                    TextAlignment="Right"
                                    TextTrimming="CharacterEllipsis" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn x:Name="gvclastModifiedDate" Width="190">
                        <GridViewColumn.Header>
                            <GridViewColumnHeader
                                Click="files_Click"
                                Content="Last Modified Date"
                                Tag="lastModifiedDate" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Path=lastModifiedDate, StringFormat='yyyy-MM-dd HH:mm:ss.ms', FallbackValue='Unknown'}" TextTrimming="CharacterEllipsis" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                </GridView>
            </ListView.View>
        </ListView>


        <GridSplitter
            x:Name="gsSplitter"
            Grid.Row="1"
            Grid.RowSpan="2"
            Grid.Column="1"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            Style="{StaticResource VerticalGridSplitter}"  />
                <DockPanel Grid.Row="2" Margin="0,15">
                    <TextBlock
               
                Height="16"
                VerticalAlignment="Center"
                FontFamily="{StaticResource Trajan Pro}"
                FontSize="16"
                Text=" Search File: " MouseDown="TextBlock_MouseDown_2" />
                    <Viewbox
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                Width="16"
                Height="16"
                Margin="5,0">
                        <Rectangle Width="16" Height="16">
                            <Rectangle.Fill>
                                <DrawingBrush>
                                    <DrawingBrush.Drawing>
                                        <DrawingGroup>
                                            <DrawingGroup.Children>
                                                <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,5.8335C16,9.0495 13.384,11.6665 10.167,11.6665 9.136,11.6665 8.144,11.3925 7.254,10.8675L2.561,15.5605C2.277,15.8435 1.9,16.0005 1.5,16.0005 1.1,16.0005 0.723000000000001,15.8435 0.439,15.5605 -0.146000000000001,14.9755 -0.146000000000001,14.0245 0.439,13.4395L5.133,8.7445C4.608,7.8555 4.333,6.8635 4.333,5.8335 4.333,2.6165 6.95,0.000500000000000611 10.167,0.000500000000000611 13.384,0.000500000000000611 16,2.6165 16,5.8335" />
                                                <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M14,5.8335C14,7.9475 12.28,9.6665 10.167,9.6665 8.053,9.6665 6.333,7.9475 6.333,5.8335 6.333,3.7195 8.053,2.0005 10.167,2.0005 12.28,2.0005 14,3.7195 14,5.8335" />
                                                <GeometryDrawing Brush="#FF424242" Geometry="F1M10.167,9.667C8.053,9.667 6.334,7.947 6.334,5.834 6.334,3.72 8.053,2 10.167,2 12.28,2 14,3.72 14,5.834 14,7.947 12.28,9.667 10.167,9.667 M10.167,1C7.502,1 5.334,3.168 5.334,5.834 5.334,6.985 5.755,8.03 6.431,8.862L1.147,14.146C0.951000000000001,14.342 0.951000000000001,14.658 1.147,14.854 1.244,14.951 1.372,15 1.5,15 1.628,15 1.756,14.951 1.854,14.854L7.138,9.569C7.969,10.245 9.015,10.667 10.167,10.667 12.832,10.667 15,8.499 15,5.834 15,3.168 12.832,1 10.167,1" />
                                            </DrawingGroup.Children>
                                        </DrawingGroup>
                                    </DrawingBrush.Drawing>
                                </DrawingBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                    </Viewbox>
                    <TextBox
               
                FontFamily="{StaticResource Trajan Pro}"
                FontSize="16"
                Text="{Binding file.FilterText, UpdateSourceTrigger=PropertyChanged}" />
                </DockPanel>
                <StatusBar
            Grid.Row="3"
            Grid.ColumnSpan="3"
            FontFamily="{StaticResource Trajan Pro}"
            FontSize="16" MouseDown="StatusBar_MouseDown">
                    <TextBlock Padding="2,0">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="Selected files: {0:N0} / {1:N0} ({2:N0} bytes)">
                                <Binding ElementName="files" Path="SelectedItems.Count" />
                                <Binding ElementName="files" Path="Items.Count" />
                                <Binding Path="SelectedSize" />
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>

                    <StatusBarItem HorizontalAlignment="Right">
                        <StackPanel Orientation="Horizontal">
                            <Button
                        x:Name="bRun"
                        Width="20"
                        Height="20"
                        Margin="6,3"
                        Padding="0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Click="bRun_Click"
                        IsEnabled="False">
                                <Button.Content>
                                    <Viewbox
                                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                Width="16"
                                Height="16">
                                        <Rectangle Width="16" Height="16">
                                            <Rectangle.Fill>
                                                <DrawingBrush>
                                                    <DrawingBrush.Drawing>
                                                        <DrawingGroup>
                                                            <DrawingGroup.Children>
                                                                <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                                <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M2.9997,-0.000199999999999534L2.9997,15.9998 13.6677,7.9998z" />
                                                                <GeometryDrawing Brush="{Binding ElementName=bRun, Path=IsEnabled, Converter={StaticResource RunEnabledColorConverter}}" Geometry="F1M4,2L4,14 12,8z" />
                                                            </DrawingGroup.Children>
                                                        </DrawingGroup>
                                                    </DrawingBrush.Drawing>
                                                </DrawingBrush>
                                            </Rectangle.Fill>
                                        </Rectangle>
                                    </Viewbox>
                                </Button.Content>
                            </Button>
                            <Button
                        x:Name="bPause"
                        Width="20"
                        Height="20"
                        Margin="0"
                        Padding="0"
                        Click="bPause_Click"
                        IsEnabled="False">
                                <Button.Content>
                                    <Viewbox
                                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                Width="16"
                                Height="16"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                                        <Rectangle Width="16" Height="16">
                                            <Rectangle.Fill>
                                                <DrawingBrush>
                                                    <DrawingBrush.Drawing>
                                                        <DrawingGroup>
                                                            <DrawingGroup.Children>
                                                                <GeometryDrawing Brush="#00f6f6f6" Geometry="M16,0V16H0V0Z" />
                                                                <GeometryDrawing Brush="#FFf6f6f6" Geometry="M13,2V13H3V2Z" />
                                                                <GeometryDrawing Brush="{Binding ElementName=bPause, Path=IsEnabled, Converter={StaticResource PauseEnabledColorConverter}}" Geometry="M4,3H7v9H4ZM9,3v9h3V3Z" />
                                                            </DrawingGroup.Children>
                                                        </DrawingGroup>
                                                    </DrawingBrush.Drawing>
                                                </DrawingBrush>
                                            </Rectangle.Fill>
                                        </Rectangle>
                                    </Viewbox>

                                </Button.Content>
                            </Button>
                            <Button
                        x:Name="bStop"
                        Width="20"
                        Height="20"
                        Margin="6,3"
                        Padding="0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Click="bStop_Click"
                        IsEnabled="False">
                                <Button.Content>
                                    <Viewbox
                                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                Width="16"
                                Height="16">
                                        <Rectangle Width="16" Height="16">
                                            <Rectangle.Fill>
                                                <DrawingBrush>
                                                    <DrawingBrush.Drawing>
                                                        <DrawingGroup>
                                                            <DrawingGroup.Children>
                                                                <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                                <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M13,13L3,13 3,3 13,3z" />
                                                                <GeometryDrawing Brush="{Binding ElementName=bStop, Path=IsEnabled, Converter={StaticResource StopEnabledColorConverter}}" Geometry="F1M12,12L4,12 4,4 12,4z" />
                                                            </DrawingGroup.Children>
                                                        </DrawingGroup>
                                                    </DrawingBrush.Drawing>
                                                </DrawingBrush>
                                            </Rectangle.Fill>
                                        </Rectangle>
                                    </Viewbox>
                                </Button.Content>
                            </Button>

                            <Grid>
                                <ProgressBar
                            x:Name="progressBar"
                            Width="300"
                            Height="20"
                            VerticalAlignment="Center"
                            Maximum="1"
                            Value="{Binding file.CurrentProgress}" />
                                <TextBlock
                            Padding="0,2,0,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontSize="14"
                            Opacity="{Binding ElementName=progressBar, Path=Value, Converter={StaticResource MathConverter}}"
                            Text="{Binding ElementName=progressBar, Path=Value, StringFormat='{}{0:P}'}" />
                            </Grid>
                        </StackPanel>
                    </StatusBarItem>
                </StatusBar>
                <Menu
            x:Name="mainMenu"
            Grid.ColumnSpan="3"
            VerticalAlignment="Top"
            FontFamily="{StaticResource Trajan Pro}"
            FontSize="16">
                    <MenuItem>
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock x:Name="tbFile" Text="File" />
                        <ContentControl x:Name="SpinnerFile"
                         
                            Margin="3,0,0,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"

                            Visibility="Collapsed" Template="{StaticResource Spinner}" />
              
                            </StackPanel>
                        </MenuItem.Header>
                        <MenuItem Click="MenuItem_Click_7" Header="Create...">
                            <MenuItem.Icon>
                                <Viewbox
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            Width="16"
                            Height="16">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0.9999,-0.000199999999999534L0.9999,13.0008 5.0009,13.0008 5.0009,15.9998 15.9999,15.9998 15.9999,7.3788 11.6209,3.0008 10.6049,3.0008 7.6179,-0.000199999999999534z" />
                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M14,14L7,14 7,5 10,5 10,9 14,9z M6,11L3,11 3,2 6.798,2 8.81,4 6,4z M11,5.207L13.793,8 11,8z M11.207,4L10.19,4 7.202,1 2,1 2,12 6,12 6,15 15,15 15,7.793z" />
                                                            <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M14,14L7,14 7,5 10,5 10,9 14,9z M6,11L3,11 3,2 6.798,2 8.81,4 6,4z M11,5.207L13.793,8 11,8z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Click="MenuItem_Click" Header="Open...">
                            <MenuItem.Icon>
                                <Viewbox
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            Width="16"
                            Height="16">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,5.3774L16,14.0004 14,14.0004 14,16.0004 4,16.0004 4,9.0004 3.499,9.0004C1.572,8.9984 0.00200000000000067,7.4284 0,5.5014 0,3.5704 1.57,2.0004 3.5,2.0004L4.504,2.0004 3.608,1.1034 4.711,0.000399999999999956 6.747,0.000399999999999956 8.747,2.0004 12.621,2.0004z" />
                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M10,8L10,6.207 11.793,8z M12.207,3L9.746,3 10.246,3.5 9.746,4 11.793,4 14,6.207 14,12 13,12 13,7.792 10.207,5 8.746,5 7.746,6 9,6 9,9 12,9 12,14 6,14 6,7.745 5.728,8.018 5,7.289 5,15 5.713,15 6,15 13,15 13,13 15,13 15,5.792z" />
                                                            <GeometryDrawing Brush="#FF00539C" Geometry="F1M8.832,3.5L5.728,6.603 5.022,5.896 6.919,4 3.5,4C2.673,4 2,4.673 2,5.5 2,6.327 2.673,7 3.5,7L3.5,8C2.12,7.999 1.001,6.88 1,5.5 1,4.122 2.122,3 3.5,3L6.918,3 5.022,1.103 5.729,0.396z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>

                        <MenuItem
                    x:Name="openMenu"
                    Header="Recent Files"
                    ItemsSource="{Binding recentFiles}">
                            <MenuItem.Style>
                                <Style TargetType="{x:Type MenuItem}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding recentFiles.Count}" Value="0">
                                            <Setter Property="IsEnabled" Value="False" />
                                        </DataTrigger>
                                    </Style.Triggers>

                                </Style>
                            </MenuItem.Style>
                            <MenuItem.Icon>
                                <Viewbox
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            Width="16"
                            Height="16">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,8C16,12.418 12.418,16 8,16 7.979,16 7.96,15.997 7.939,15.997 7.919,15.997 7.9,16 7.879,16 7.817,16 7.758,15.986 7.695,15.984 7.439,15.975 7.186,15.954 6.936,15.921 3.754,15.538 1.044,13.278 0.175000000000001,10.133L0,9.5 0,9.143 0,3 0,1 3,1 3,1.68C4.133,0.795 5.491,0.252 6.935,0.0789999999999997 7.185,0.0460000000000003 7.438,0.0250000000000004 7.696,0.016 7.758,0.0140000000000002 7.817,0 7.879,0 7.9,0 7.919,0.00300000000000011 7.939,0.00300000000000011 7.96,0.00300000000000011 7.979,0 8,0 12.418,0 16,3.582 16,8" />
                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M10.3701,10.6641L9.6301,11.3361 7.0001,8.4431 7.0001,4.0001 8.0001,4.0001 8.0001,8.0571z" />
                                                            <GeometryDrawing Brush="#FF329932" Geometry="F1M14.8799,8C14.8799,11.859 11.7389,15 7.8799,15 4.7459,15 1.9739,12.889 1.1389,9.866L2.1029,9.601C2.8179,12.19 5.1939,14 7.8799,14 11.1889,14 13.8799,11.309 13.8799,8 13.8799,4.691 11.1889,2 7.8799,2 5.7209,2 3.7609,3.174 2.7019,5L4.9999,5 4.9999,6 0.999899999999998,6 0.999899999999998,2 1.9999,2 1.9999,4.25C3.2659,2.267 5.4629,1 7.8799,1 11.7389,1 14.8799,4.14 14.8799,8" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </MenuItem.Icon>
                            <MenuItem.ItemContainerStyle>

                                <Style TargetType="MenuItem">
                                    <Setter Property="Header" Value="{Binding Title}" />
                                    <Setter Property="Command" Value="{Binding OnClickCommand}" />
                                    <Setter Property="CommandParameter" Value="{Binding FileName}" />
                                    <Setter Property="ToolTip" Value="{Binding FileName}" />
                                    <Setter Property="Icon" Value="{StaticResource hotFiles}" />
                                </Style>
                            </MenuItem.ItemContainerStyle>
                        </MenuItem>

                <MenuItem
                   
                    Header="Clear Cache" Click="MenuItem_Click_9"
                  >
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16">
                            <Canvas Width="24" Height="24">
                                <Path Fill="Black" Data="M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M11,5V3H13V5H11M11,21V19H13V21H11Z" />
                            </Canvas>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator />
                        <MenuItem Click="MenuItem_Click_1" Header="Exit">
                            <MenuItem.Icon>
                                <Viewbox
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            Width="16"
                            Height="16">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,0.999700000000001L0,6.9997 0,14.9997 0,15.9997 10,15.9997 10,14.9997 16,14.9997 16,0.999700000000001z" />
                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M1,15L9,15 9,8 1,8z M15,2L15,14 10,14 10,13 14,13 14,5 2,5 2,7 1,7 1,2z" />
                                                            <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M14,5L14,13 10,13 10,7 2,7 2,5z" />
                                                            <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M8,14L6.5,14 5,12.5 3.5,14 2,14 4.25,11.75 2,9.5 3.5,9.5 5,11 6.5,9.5 8,9.5 5.75,11.75z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator />
                    </MenuItem>
                    <MenuItem>
                        <MenuItem.Header>
                            <TextBlock Text="View" />
                        </MenuItem.Header>
                        <MenuItem
                    Checked="MenuItem_Checked"
                    Header="Group by Extension"
                    IsCheckable="True"
                    IsChecked="True"
                    Unchecked="MenuItem_Unchecked" />
                        <MenuItem
                    Checked="MenuItem_Checked_1"
                    Header="Preview Content"
                    IsCheckable="True"
                    IsChecked="True"
                    Unchecked="MenuItem_Unchecked_1" />
                <MenuItem
              
                    Header="View Latest Changes in BAR file"
                    IsCheckable="True"
                    IsChecked="{Binding file.IsLatestChangesVisible, Mode=TwoWay}"
                 />
            </MenuItem>

            <MenuItem>
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock x:Name="tbExtract" Text="Extract" />
                        <ContentControl  x:Name="SpinnerExtract"
                            Width="16"
                            Margin="3,0,0,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Visibility="Collapsed" Template="{StaticResource Spinner}" />
                    </StackPanel>
                        </MenuItem.Header>
                        <MenuItem
                    Click="extractMenuItem"
                    Header="All Files..."
                    Tag="All">
                            <MenuItem.Icon>
                                <Viewbox
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            Width="16"
                            Height="16">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,12L11.681,12.003 11.341,13.366 9.752,12.193C9.575,12.063 9.366,11.994 9.147,11.994 8.843,11.994 8.559,12.129 8.367,12.364 8.062,12.736 8.062,13.275 8.365,13.648L9.619,15.185 7.716,15.751C7.16,15.916 6.583,16 6.001,16 4.623,16 3.275,15.519 2.207,14.649 0.965999999999999,13.636 0.193,12.199 0.0310000000000006,10.604 -0.129999999999999,9.009 0.339,7.448 1.353,6.206 1.552,5.963 1.771,5.743 2,5.537L2,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M4,4L6.002,4C5.802,4 5.601,4.01 5.397,4.03 4.913,4.079 4.447,4.191 4,4.348z M6.002,4L14,4 14,10 11.983,10C11.98,8.224 11.2,6.498 9.795,5.352 8.71,4.467 7.399,4 6.002,4 M14,3L4,3 4,2 14,2z M7.214,8.179C6.768,8.663 6.121,8.319 5.677,8.024 5.209,7.712 5.597,6.991 6.062,7.185 6.294,6.855 6.785,6.646 7.144,6.819 7.634,7.054 7.526,7.839 7.214,8.179 M5.077,12.138C4.703,12.167 4.277,11.943 4.21,11.589 4.118,11.108 4.767,10.725 5.193,10.747 5.801,10.778 5.897,11.434 5.918,11.919 5.94,12.431 5.186,12.579 5.077,12.138 M3.722,10.044C3.477,10.385 2.951,10.076 3.108,9.735 2.869,9.553 2.727,9.182 2.865,8.919 3.054,8.561 3.635,8.663 3.88,8.905 4.228,9.25 3.954,9.722 3.722,10.044 M8.676,6.723C7.914,6.1 6.98,5.769 6.009,5.769 5.865,5.769 5.721,5.776 5.575,5.791 4.451,5.904 3.438,6.449 2.723,7.324 2.009,8.2 1.678,9.301 1.792,10.426 1.905,11.55 2.45,12.562 3.325,13.277 4.277,14.054 5.509,14.373 6.705,14.171 6.24,13.241 6.348,12.095 7.027,11.263 7.807,10.309 9.11,10.025 10.196,10.509 10.367,9.084 9.801,7.641 8.676,6.723" />
                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M5.1935,10.7471C5.8015,10.7781 5.8965,11.4341 5.9175,11.9191 5.9405,12.4311 5.1855,12.5791 5.0775,12.1381 4.7025,12.1671 4.2775,11.9431 4.2105,11.5891 4.1185,11.1081 4.7675,10.7251 5.1935,10.7471 M3.8795,8.9051C4.2285,9.2501 3.9545,9.7221 3.7225,10.0441 3.4775,10.3841 2.9505,10.0751 3.1075,9.7351 2.8695,9.5531 2.7275,9.1821 2.8655,8.9191 3.0535,8.5611 3.6355,8.6631 3.8795,8.9051 M7.2135,8.1791C6.7675,8.6631 6.1215,8.3191 5.6775,8.0241 5.2085,7.7121 5.5965,6.9911 6.0625,7.1851 6.2935,6.8551 6.7845,6.6461 7.1445,6.8191 7.6335,7.0531 7.5265,7.8391 7.2135,8.1791 M6.0085,5.7691C5.8655,5.7691 5.7205,5.7761 5.5755,5.7911 4.4505,5.9041 3.4385,6.4491 2.7235,7.3241 2.0085,8.2001 1.6775,9.3011 1.7915,10.4261 1.9055,11.5501 2.4505,12.5621 3.3255,13.2771 4.2765,14.0541 5.5085,14.3731 6.7045,14.1711 6.2405,13.2411 6.3485,12.0951 7.0265,11.2631 7.8075,10.3091 9.1095,10.0251 10.1955,10.5091 10.3675,9.0841 9.8005,7.6401 8.6765,6.7221 7.9135,6.1001 6.9805,5.7691 6.0085,5.7691 M6.0005,15.0001C4.8625,15.0001 3.7435,14.6111 2.8385,13.8731 1.8045,13.0291 1.1605,11.8321 1.0255,10.5031 0.891500000000001,9.1741 1.2825,7.8721 2.1275,6.8381 2.9725,5.8031 4.1685,5.1591 5.4975,5.0251 6.8235,4.8941 8.1265,5.2811 9.1625,6.1261 10.6525,7.3421 11.3135,9.3361 10.8485,11.2071L10.7095,11.7651 10.2475,11.4241C9.4235,10.8171 8.2705,10.9581 7.6225,11.7501 7.0475,12.4541 7.0465,13.4751 7.6205,14.1791L7.9855,14.6271 7.4315,14.7911C6.9615,14.9321,6.4795,15.0001,6.0005,15.0001 M14.0005,3.0001L4.0005,3.0001 4.0005,2.0001 14.0005,2.0001z M3.0005,1.0001L3.0005,4.8081C3.3175,4.6241,3.6525,4.4711,4.0005,4.3491L4.0005,4.0001 14.0005,4.0001 14.0005,10.0001 12.0005,10.0001 12.0005,11.0041C12.0005,11.0041,15.0005,10.9451,15.0005,11.0001L15.0005,1.0001z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem
                    Click="extractMenuItem"
                    Header="Selected..."
                    Tag="Selected">
                            <MenuItem.Icon>
                                <Viewbox
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            Width="16"
                            Height="16">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,0L16,12 15.949,12C15.697,14.244 13.81,16 11.5,16 10.638,16 9.841,15.744 9.156,15.323L7.716,15.751C7.16,15.916 6.583,16 6.001,16 4.623,16 3.275,15.519 2.207,14.649 0.965999999999999,13.636 0.193,12.199 0.0310000000000006,10.604 -0.129999999999999,9.009 0.339,7.448 1.353,6.206 1.552,5.963 1.771,5.743 2,5.537L2,0z" />
                                                            <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M4,4L6.003,4C5.803,4 5.602,4.01 5.397,4.03 4.913,4.079 4.447,4.191 4,4.348z M6.003,4L14,4 14,7.785C13.259,7.282 12.396,7 11.5,7 11.404,7 11.312,7.017 11.218,7.023L10.987,6.676C10.651,6.168 10.25,5.723 9.795,5.352 8.71,4.467 7.399,4 6.003,4 M14,3L4,3 4,2 14,2z M7.214,8.179C6.768,8.663 6.121,8.319 5.677,8.024 5.209,7.712 5.597,6.991 6.062,7.185 6.294,6.855 6.785,6.646 7.144,6.819 7.634,7.054 7.526,7.839 7.214,8.179 M5.077,12.138C4.703,12.167 4.277,11.943 4.21,11.589 4.118,11.108 4.767,10.725 5.193,10.747 5.801,10.778 5.897,11.434 5.918,11.919 5.94,12.431 5.186,12.579 5.077,12.138 M3.722,10.044C3.477,10.385 2.951,10.076 3.108,9.735 2.869,9.553 2.727,9.182 2.865,8.919 3.054,8.561 3.635,8.663 3.88,8.905 4.228,9.25 3.954,9.722 3.722,10.044 M8.676,6.723C7.914,6.1 6.98,5.769 6.009,5.769 5.865,5.769 5.721,5.776 5.575,5.791 4.451,5.904 3.438,6.449 2.723,7.324 2.009,8.2 1.678,9.301 1.792,10.426 1.905,11.55 2.45,12.562 3.325,13.277 4.277,14.054 5.509,14.373 6.705,14.171 6.241,13.243 6.349,12.1 7.023,11.269 7.108,9.638 8.059,8.246 9.43,7.528 9.217,7.231 8.966,6.959 8.676,6.723" />
                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M7.2172,12.8095C7.0892,12.3925 7.0002,11.9585 7.0002,11.4995 7.0002,11.4215 7.0192,11.3475 7.0232,11.2695 6.3482,12.1005 6.2412,13.2435 6.7042,14.1715 5.5092,14.3735 4.2762,14.0535 3.3252,13.2775 2.4502,12.5625 1.9052,11.5495 1.7912,10.4255 1.6782,9.3015 2.0092,8.1995 2.7232,7.3245 3.4382,6.4495 4.4512,5.9045 5.5752,5.7905 5.7202,5.7755 5.8652,5.7685 6.0092,5.7685 6.9802,5.7685 7.9142,6.0995 8.6762,6.7225 8.9662,6.9595 9.2172,7.2315 9.4292,7.5285 9.6612,7.4075 9.9012,7.3085 10.1542,7.2285 9.8832,6.8195 9.5532,6.4445 9.1622,6.1265 8.1262,5.2815 6.8242,4.8935 5.4982,5.0245 4.1692,5.1595 2.9722,5.8035 2.1272,6.8375 1.2822,7.8725 0.8912,9.1745 1.0262,10.5025 1.1602,11.8315 1.8042,13.0295 2.8392,13.8735 3.7432,14.6115 4.8622,14.9995 6.0012,14.9995 6.4792,14.9995 6.9612,14.9315 7.4322,14.7915L7.9852,14.6275 7.6202,14.1795C7.2982,13.7845,7.1772,13.2925,7.2172,12.8095 M14.0002,1.9995L4.0002,1.9995 4.0002,2.9995 14.0002,2.9995z M14.0002,3.9995L4.0002,3.9995 4.0002,4.3485C3.6522,4.4715,3.3182,4.6245,3.0002,4.8085L3.0002,0.999499999999999 15.0002,0.999499999999999 15.0002,8.7185C14.7602,8.4025,14.5692,8.2235,14.5692,8.2235L14.5382,8.1955C14.3702,8.0415,14.1862,7.9115,14.0002,7.7845z M4.2102,11.5895C4.2772,11.9435 4.7032,12.1675 5.0772,12.1375 5.1862,12.5785 5.9402,12.4315 5.9182,11.9195 5.8962,11.4345 5.8012,10.7785 5.1932,10.7475 4.7672,10.7255 4.1182,11.1075 4.2102,11.5895 M2.8652,8.9185C2.7272,9.1815 2.8692,9.5535 3.1082,9.7345 2.9502,10.0755 3.4772,10.3845 3.7222,10.0445 3.9542,9.7215 4.2282,9.2505 3.8802,8.9045 3.6352,8.6625 3.0532,8.5605 2.8652,8.9185 M7.2132,8.1785C6.7682,8.6635 6.1212,8.3195 5.6772,8.0245 5.2082,7.7125 5.5972,6.9905 6.0622,7.1845 6.2942,6.8555 6.7842,6.6465 7.1442,6.8185 7.6342,7.0535 7.5262,7.8395 7.2132,8.1785" />
                                                            <GeometryDrawing Brush="#FF329932" Geometry="F1M15,11.5C15,13.433 13.433,15 11.5,15 9.567,15 8,13.433 8,11.5 8,9.567 9.567,8 11.5,8 12.414,8 13.238,8.358 13.861,8.932L10.5,12.293 9.354,11.146 8.646,11.854 10.5,13.707 14.494,9.713C14.32,9.422,15,10.48,15,11.5" />
                                                            <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1M8.6635,11.8664L9.3595,11.1544 10.4855,12.2644 13.8315,8.9344C13.8315,8.9344,14.3955,9.5474,14.4615,9.6964L10.4855,13.6724z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                <MenuItem
                    Click="extractMenuItem"
                    Header="From the list of paths..."
                    Tag="List">
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16">
                            <Canvas Width="24" Height="24">
                                <Path Fill="Black" Data="M17.75 21.16L15 18.16L16.16 17L17.75 18.59L21.34 15L22.5 16.41L17.75 21.16M3 3H21V5C19.9 5 19 5.9 19 7V12C18.3 12 17.63 12.12 17 12.34V5H7V7H12V8H7V9H10V10H7V11H10V12H7V13H12V14H7V15H10V16H7V19H13.08C13.2 19.72 13.45 20.39 13.8 21H7C5.9 21 5 20.11 5 19V7C5 5.9 4.11 5 3 5V3Z" />
                            </Canvas>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>


                <MenuItem
                    
                    Header="Bar Entries Details as JSON" Click="MenuItem_Click_8"
                    >
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16">
                            <Canvas Width="24" Height="24">
                                <Path Fill="Black" Data="M21 11.1V8C21 6.9 20.1 6 19 6H11L9 4H3C1.9 4 1 4.9 1 6V18C1 19.1 1.9 20 3 20H10.2C11.4 21.8 13.6 23 16 23C19.9 23 23 19.9 23 16C23 14.1 22.2 12.4 21 11.1M9.3 18H3V8H19V9.7C18.1 9.2 17.1 9 16 9C12.1 9 9 12.1 9 16C9 16.7 9.1 17.4 9.3 18M16 21C13.2 21 11 18.8 11 16S13.2 11 16 11 21 13.2 21 16 18.8 21 16 21M17 14H15V12H17V14M17 20H15V15H17V20Z" />
                            </Canvas>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>

            </MenuItem>
                    <MenuItem >
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock x:Name="tbConvert" Text="Convert" />
                        <ContentControl  x:Name="SpinnerConvert"
                            Width="16"
                            Margin="3,0,0,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Visibility="Collapsed" Template="{StaticResource Spinner}" />
                    </StackPanel>
                        </MenuItem.Header>
                <MenuItem
               
                    Header="XML"
>
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.9998,-0.000199999999999534L1.9998,9.7948 -0.000199999999999978,11.7948 -0.000199999999999978,12.2048 1.9998,14.2058 1.9998,15.9998 15.0008,15.9998 15.0008,4.3788 10.6208,-0.000199999999999534z" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13,14L13,13.205 12.205,14z M9,6L9,2 4,2 4,8 10.205,8 13,10.795 13,6z M12.793,5L10,5 10,2.207z" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M2.9997,0.999700000000001L2.9997,8.7957 3.7957,7.9997 3.9997,7.9997 3.9997,1.9997 8.9997,1.9997 8.9997,5.9997 12.9997,5.9997 12.9997,10.7957 14.0007,11.7957 14.0007,4.7937 10.2067,0.999700000000001z M9.9997,2.2067L12.7927,5.0007 9.9997,5.0007z M5.3357,14.8147L6.2637,15.1857 8.6647,9.1857 7.7357,8.8147z M9.2307,9.8537L11.3767,12.0007 9.2307,14.1467 9.9377,14.8537 12.7907,12.0007 9.9377,9.1467z M1.2097,12.0007L4.0627,14.8537 4.7697,14.1467 2.6237,12.0007 4.7697,9.8537 4.0627,9.1467z M12.9997,13.2057L12.9997,14.0007 12.2047,14.0007 11.2047,14.9997 14.0007,14.9997 14.0007,12.2047z" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                
                <MenuItem
                 Click="convertFiles"
                    Header="To XMB (DE)"
                    Tag="toxmbde">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.9998,-0.000199999999999534L1.9998,9.7948 -0.000199999999999978,11.7948 -0.000199999999999978,12.2048 1.9998,14.2058 1.9998,15.9998 15.0008,15.9998 15.0008,4.3788 10.6208,-0.000199999999999534z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13,14L13,13.205 12.205,14z M9,6L9,2 4,2 4,8 10.205,8 13,10.795 13,6z M12.793,5L10,5 10,2.207z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M2.9997,0.999700000000001L2.9997,8.7957 3.7957,7.9997 3.9997,7.9997 3.9997,1.9997 8.9997,1.9997 8.9997,5.9997 12.9997,5.9997 12.9997,10.7957 14.0007,11.7957 14.0007,4.7937 10.2067,0.999700000000001z M9.9997,2.2067L12.7927,5.0007 9.9997,5.0007z M5.3357,14.8147L6.2637,15.1857 8.6647,9.1857 7.7357,8.8147z M9.2307,9.8537L11.3767,12.0007 9.2307,14.1467 9.9377,14.8537 12.7907,12.0007 9.9377,9.1467z M1.2097,12.0007L4.0627,14.8537 4.7697,14.1467 2.6237,12.0007 4.7697,9.8537 4.0627,9.1467z M12.9997,13.2057L12.9997,14.0007 12.2047,14.0007 11.2047,14.9997 14.0007,14.9997 14.0007,12.2047z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                 Click="convertFiles"
                    Header="To XMB (Legacy)"
                    Tag="toxmbcc">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.9998,-0.000199999999999534L1.9998,9.7948 -0.000199999999999978,11.7948 -0.000199999999999978,12.2048 1.9998,14.2058 1.9998,15.9998 15.0008,15.9998 15.0008,4.3788 10.6208,-0.000199999999999534z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13,14L13,13.205 12.205,14z M9,6L9,2 4,2 4,8 10.205,8 13,10.795 13,6z M12.793,5L10,5 10,2.207z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M2.9997,0.999700000000001L2.9997,8.7957 3.7957,7.9997 3.9997,7.9997 3.9997,1.9997 8.9997,1.9997 8.9997,5.9997 12.9997,5.9997 12.9997,10.7957 14.0007,11.7957 14.0007,4.7937 10.2067,0.999700000000001z M9.9997,2.2067L12.7927,5.0007 9.9997,5.0007z M5.3357,14.8147L6.2637,15.1857 8.6647,9.1857 7.7357,8.8147z M9.2307,9.8537L11.3767,12.0007 9.2307,14.1467 9.9377,14.8537 12.7907,12.0007 9.9377,9.1467z M1.2097,12.0007L4.0627,14.8537 4.7697,14.1467 2.6237,12.0007 4.7697,9.8537 4.0627,9.1467z M12.9997,13.2057L12.9997,14.0007 12.2047,14.0007 11.2047,14.9997 14.0007,14.9997 14.0007,12.2047z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                 Click="convertFiles"
                    Header="To JSON"
                    Tag="xmltojson">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16">
                                <Canvas Width="24" Height="24">
                                    <Path Fill="Black" Data="M5,3H7V5H5V10A2,2 0 0,1 3,12A2,2 0 0,1 5,14V19H7V21H5C3.93,20.73 3,20.1 3,19V15A2,2 0 0,0 1,13H0V11H1A2,2 0 0,0 3,9V5A2,2 0 0,1 5,3M19,3A2,2 0 0,1 21,5V9A2,2 0 0,0 23,11H24V13H23A2,2 0 0,0 21,15V19A2,2 0 0,1 19,21H17V19H19V14A2,2 0 0,1 21,12A2,2 0 0,1 19,10V5H17V3H19M12,15A1,1 0 0,1 13,16A1,1 0 0,1 12,17A1,1 0 0,1 11,16A1,1 0 0,1 12,15M8,15A1,1 0 0,1 9,16A1,1 0 0,1 8,17A1,1 0 0,1 7,16A1,1 0 0,1 8,15M16,15A1,1 0 0,1 17,16A1,1 0 0,1 16,17A1,1 0 0,1 15,16A1,1 0 0,1 16,15Z" />
                                </Canvas>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>

                <MenuItem
                
                    Header="XMB"
                   >
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.9998,-0.000199999999999534L1.9998,9.7948 -0.000199999999999978,11.7948 -0.000199999999999978,12.2048 1.9998,14.2058 1.9998,15.9998 15.0008,15.9998 15.0008,4.3788 10.6208,-0.000199999999999534z" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13,14L13,13.205 12.205,14z M9,6L9,2 4,2 4,8 10.205,8 13,10.795 13,6z M12.793,5L10,5 10,2.207z" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M2.9997,0.999700000000001L2.9997,8.7957 3.7957,7.9997 3.9997,7.9997 3.9997,1.9997 8.9997,1.9997 8.9997,5.9997 12.9997,5.9997 12.9997,10.7957 14.0007,11.7957 14.0007,4.7937 10.2067,0.999700000000001z M9.9997,2.2067L12.7927,5.0007 9.9997,5.0007z M5.3357,14.8147L6.2637,15.1857 8.6647,9.1857 7.7357,8.8147z M9.2307,9.8537L11.3767,12.0007 9.2307,14.1467 9.9377,14.8537 12.7907,12.0007 9.9377,9.1467z M1.2097,12.0007L4.0627,14.8537 4.7697,14.1467 2.6237,12.0007 4.7697,9.8537 4.0627,9.1467z M12.9997,13.2057L12.9997,14.0007 12.2047,14.0007 11.2047,14.9997 14.0007,14.9997 14.0007,12.2047z" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                    <MenuItem
                 Click="convertFiles"
                    Header="To XML"
                    Tag="toxml">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.9998,-0.000199999999999534L1.9998,9.7948 -0.000199999999999978,11.7948 -0.000199999999999978,12.2048 1.9998,14.2058 1.9998,15.9998 15.0008,15.9998 15.0008,4.3788 10.6208,-0.000199999999999534z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13,14L13,13.205 12.205,14z M9,6L9,2 4,2 4,8 10.205,8 13,10.795 13,6z M12.793,5L10,5 10,2.207z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M2.9997,0.999700000000001L2.9997,8.7957 3.7957,7.9997 3.9997,7.9997 3.9997,1.9997 8.9997,1.9997 8.9997,5.9997 12.9997,5.9997 12.9997,10.7957 14.0007,11.7957 14.0007,4.7937 10.2067,0.999700000000001z M9.9997,2.2067L12.7927,5.0007 9.9997,5.0007z M5.3357,14.8147L6.2637,15.1857 8.6647,9.1857 7.7357,8.8147z M9.2307,9.8537L11.3767,12.0007 9.2307,14.1467 9.9377,14.8537 12.7907,12.0007 9.9377,9.1467z M1.2097,12.0007L4.0627,14.8537 4.7697,14.1467 2.6237,12.0007 4.7697,9.8537 4.0627,9.1467z M12.9997,13.2057L12.9997,14.0007 12.2047,14.0007 11.2047,14.9997 14.0007,14.9997 14.0007,12.2047z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                 Click="convertFiles"
                    Header="To JSON"
                    Tag="xmbtojson">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16">
                                <Canvas Width="24" Height="24">
                                    <Path Fill="Black" Data="M5,3H7V5H5V10A2,2 0 0,1 3,12A2,2 0 0,1 5,14V19H7V21H5C3.93,20.73 3,20.1 3,19V15A2,2 0 0,0 1,13H0V11H1A2,2 0 0,0 3,9V5A2,2 0 0,1 5,3M19,3A2,2 0 0,1 21,5V9A2,2 0 0,0 23,11H24V13H23A2,2 0 0,0 21,15V19A2,2 0 0,1 19,21H17V19H19V14A2,2 0 0,1 21,12A2,2 0 0,1 19,10V5H17V3H19M12,15A1,1 0 0,1 13,16A1,1 0 0,1 12,17A1,1 0 0,1 11,16A1,1 0 0,1 12,15M8,15A1,1 0 0,1 9,16A1,1 0 0,1 8,17A1,1 0 0,1 7,16A1,1 0 0,1 8,15M16,15A1,1 0 0,1 17,16A1,1 0 0,1 16,17A1,1 0 0,1 15,16A1,1 0 0,1 16,15Z" />
                                </Canvas>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
                <MenuItem
                
                    Header="JSON"
                    >
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16">
                            <Canvas Width="24" Height="24">
                                <Path Fill="Black" Data="M5,3H7V5H5V10A2,2 0 0,1 3,12A2,2 0 0,1 5,14V19H7V21H5C3.93,20.73 3,20.1 3,19V15A2,2 0 0,0 1,13H0V11H1A2,2 0 0,0 3,9V5A2,2 0 0,1 5,3M19,3A2,2 0 0,1 21,5V9A2,2 0 0,0 23,11H24V13H23A2,2 0 0,0 21,15V19A2,2 0 0,1 19,21H17V19H19V14A2,2 0 0,1 21,12A2,2 0 0,1 19,10V5H17V3H19M12,15A1,1 0 0,1 13,16A1,1 0 0,1 12,17A1,1 0 0,1 11,16A1,1 0 0,1 12,15M8,15A1,1 0 0,1 9,16A1,1 0 0,1 8,17A1,1 0 0,1 7,16A1,1 0 0,1 8,15M16,15A1,1 0 0,1 17,16A1,1 0 0,1 16,17A1,1 0 0,1 15,16A1,1 0 0,1 16,15Z" />
                            </Canvas>
                        </Viewbox>
                    </MenuItem.Icon>
                    <MenuItem
                 Click="convertFiles"
                    Header="To XMB (DE)"
                    Tag="jsontoxmbde">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.9998,-0.000199999999999534L1.9998,9.7948 -0.000199999999999978,11.7948 -0.000199999999999978,12.2048 1.9998,14.2058 1.9998,15.9998 15.0008,15.9998 15.0008,4.3788 10.6208,-0.000199999999999534z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13,14L13,13.205 12.205,14z M9,6L9,2 4,2 4,8 10.205,8 13,10.795 13,6z M12.793,5L10,5 10,2.207z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M2.9997,0.999700000000001L2.9997,8.7957 3.7957,7.9997 3.9997,7.9997 3.9997,1.9997 8.9997,1.9997 8.9997,5.9997 12.9997,5.9997 12.9997,10.7957 14.0007,11.7957 14.0007,4.7937 10.2067,0.999700000000001z M9.9997,2.2067L12.7927,5.0007 9.9997,5.0007z M5.3357,14.8147L6.2637,15.1857 8.6647,9.1857 7.7357,8.8147z M9.2307,9.8537L11.3767,12.0007 9.2307,14.1467 9.9377,14.8537 12.7907,12.0007 9.9377,9.1467z M1.2097,12.0007L4.0627,14.8537 4.7697,14.1467 2.6237,12.0007 4.7697,9.8537 4.0627,9.1467z M12.9997,13.2057L12.9997,14.0007 12.2047,14.0007 11.2047,14.9997 14.0007,14.9997 14.0007,12.2047z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                 Click="convertFiles"
                    Header="To XMB (Legacy)"
                    Tag="jsontoxmblegacy">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.9998,-0.000199999999999534L1.9998,9.7948 -0.000199999999999978,11.7948 -0.000199999999999978,12.2048 1.9998,14.2058 1.9998,15.9998 15.0008,15.9998 15.0008,4.3788 10.6208,-0.000199999999999534z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13,14L13,13.205 12.205,14z M9,6L9,2 4,2 4,8 10.205,8 13,10.795 13,6z M12.793,5L10,5 10,2.207z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M2.9997,0.999700000000001L2.9997,8.7957 3.7957,7.9997 3.9997,7.9997 3.9997,1.9997 8.9997,1.9997 8.9997,5.9997 12.9997,5.9997 12.9997,10.7957 14.0007,11.7957 14.0007,4.7937 10.2067,0.999700000000001z M9.9997,2.2067L12.7927,5.0007 9.9997,5.0007z M5.3357,14.8147L6.2637,15.1857 8.6647,9.1857 7.7357,8.8147z M9.2307,9.8537L11.3767,12.0007 9.2307,14.1467 9.9377,14.8537 12.7907,12.0007 9.9377,9.1467z M1.2097,12.0007L4.0627,14.8537 4.7697,14.1467 2.6237,12.0007 4.7697,9.8537 4.0627,9.1467z M12.9997,13.2057L12.9997,14.0007 12.2047,14.0007 11.2047,14.9997 14.0007,14.9997 14.0007,12.2047z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                 Click="convertFiles"
                    Header="To XML"
                    Tag="jsontoxml">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.9998,-0.000199999999999534L1.9998,9.7948 -0.000199999999999978,11.7948 -0.000199999999999978,12.2048 1.9998,14.2058 1.9998,15.9998 15.0008,15.9998 15.0008,4.3788 10.6208,-0.000199999999999534z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13,14L13,13.205 12.205,14z M9,6L9,2 4,2 4,8 10.205,8 13,10.795 13,6z M12.793,5L10,5 10,2.207z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M2.9997,0.999700000000001L2.9997,8.7957 3.7957,7.9997 3.9997,7.9997 3.9997,1.9997 8.9997,1.9997 8.9997,5.9997 12.9997,5.9997 12.9997,10.7957 14.0007,11.7957 14.0007,4.7937 10.2067,0.999700000000001z M9.9997,2.2067L12.7927,5.0007 9.9997,5.0007z M5.3357,14.8147L6.2637,15.1857 8.6647,9.1857 7.7357,8.8147z M9.2307,9.8537L11.3767,12.0007 9.2307,14.1467 9.9377,14.8537 12.7907,12.0007 9.9377,9.1467z M1.2097,12.0007L4.0627,14.8537 4.7697,14.1467 2.6237,12.0007 4.7697,9.8537 4.0627,9.1467z M12.9997,13.2057L12.9997,14.0007 12.2047,14.0007 11.2047,14.9997 14.0007,14.9997 14.0007,12.2047z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
                <MenuItem
                
                    Header="DDT"
                    >
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,15L16,15 16,0 0,0z" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M10,4.5C10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3 10.672,3 10,3.672 10,4.5 M5,6.293L2,9.293 2,2 14,2 14,11.293 12,9.293 10,11.293z" />
                                                    <GeometryDrawing Brush="#FF1AA1E2" Geometry="F1M1,10L5,6.293 10,11.293 12,9.293 15,12 15,14 1,14z" />
                                                    <GeometryDrawing Brush="#FFC17C1A" Geometry="F1M11.5,3C10.672,3 10,3.672 10,4.5 10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                    <MenuItem
                 Click="convertFiles"
                    Header="to TGA"
                    Tag="totga">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,15L16,15 16,0 0,0z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M10,4.5C10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3 10.672,3 10,3.672 10,4.5 M5,6.293L2,9.293 2,2 14,2 14,11.293 12,9.293 10,11.293z" />
                                                        <GeometryDrawing Brush="#FF1AA1E2" Geometry="F1M1,10L5,6.293 10,11.293 12,9.293 15,12 15,14 1,14z" />
                                                        <GeometryDrawing Brush="#FFC17C1A" Geometry="F1M11.5,3C10.672,3 10,3.672 10,4.5 10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                 Click="convertFiles"
                    Header="to PNG"
                    Tag="topng">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,15L16,15 16,0 0,0z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M10,4.5C10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3 10.672,3 10,3.672 10,4.5 M5,6.293L2,9.293 2,2 14,2 14,11.293 12,9.293 10,11.293z" />
                                                        <GeometryDrawing Brush="#FF1AA1E2" Geometry="F1M1,10L5,6.293 10,11.293 12,9.293 15,12 15,14 1,14z" />
                                                        <GeometryDrawing Brush="#FFC17C1A" Geometry="F1M11.5,3C10.672,3 10,3.672 10,4.5 10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
                <MenuItem
                
                    Header="TGA"
                    >
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,15L16,15 16,0 0,0z" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M10,4.5C10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3 10.672,3 10,3.672 10,4.5 M5,6.293L2,9.293 2,2 14,2 14,11.293 12,9.293 10,11.293z" />
                                                    <GeometryDrawing Brush="#FF1AA1E2" Geometry="F1M1,10L5,6.293 10,11.293 12,9.293 15,12 15,14 1,14z" />
                                                    <GeometryDrawing Brush="#FFC17C1A" Geometry="F1M11.5,3C10.672,3 10,3.672 10,4.5 10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                    <MenuItem
                 Click="convertFiles"
                    Header="to DDT"
                    Tag="tgatoddt">
                        <MenuItem.Icon>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,15L16,15 16,0 0,0z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M1,1L1,10 2,9.073 2,2 14,2 14,11.098 15,12 15,1z" />
                                                        <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M10,4.5C10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3 10.672,3 10,3.672 10,4.5 M5,6.293L2,9.293 2,2 14,2 14,11.293 12,9.293 10,11.293z" />
                                                        <GeometryDrawing Brush="#FF1AA1E2" Geometry="F1M1,10L5,6.293 10,11.293 12,9.293 15,12 15,14 1,14z" />
                                                        <GeometryDrawing Brush="#FFC17C1A" Geometry="F1M11.5,3C10.672,3 10,3.672 10,4.5 10,5.328 10.672,6 11.5,6 12.328,6 13,5.328 13,4.5 13,3.672 12.328,3 11.5,3" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </MenuItem.Icon>
                    </MenuItem>
                
                </MenuItem>
            </MenuItem>
                    <MenuItem Click="MenuItem_Click_5">
                        <MenuItem.Header>
                            <TextBlock Text="Compare" />
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem>
                        <MenuItem.Header>
                            <TextBlock Text="Help" />
                        </MenuItem.Header>
                        <MenuItem Click="MenuItem_Click_4" Header="Github Page">
                            <MenuItem.Icon>
                        <Viewbox Width="16" Height="16">
                            <Canvas Width="24" Height="24">
                                <Path Fill="Black" Data="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z" />
                            </Canvas>
                        </Viewbox>
                    </MenuItem.Icon>
                        </MenuItem>
                <MenuItem Header="Leave Feedback" Click="MenuItem_Click_10">
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16">
                            <Canvas Width="24" Height="24">
                                <Path Fill="Black" Data="M9 22C8.4 22 8 21.6 8 21V18H4C2.9 18 2 17.1 2 16V4C2 2.9 2.9 2 4 2H20C21.1 2 22 2.9 22 4V16C22 17.1 21.1 18 20 18H13.9L10.2 21.7C10 21.9 9.8 22 9.5 22H9M10 16V19.1L13.1 16H20V4H4V16H10M16.3 6L14.9 9H17V13H13V8.8L14.3 6H16.3M10.3 6L8.9 9H11V13H7V8.8L8.3 6H10.3Z" />
                            </Canvas>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Release Notes" Click="MenuItem_Click_11">
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16">
                            <Canvas Width="24" Height="24">
                                <Path Fill="#FF1AA1E2" Data="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z" />
                            </Canvas>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Click="MenuItem_Click_3" Header="About">
                            <MenuItem.Icon>
                                <Viewbox
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            Width="16"
                            Height="16">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,8C0,3.582 3.582,0 8,0 12.418,0 16,3.582 16,8 16,12.418 12.418,16 8,16 3.582,16 0,12.418 0,8" />
                                                            <GeometryDrawing Brush="#FF1AA1E2" Geometry="F1M11,7C11,8.104,10.102,9,9,9L9,10 7,10 7,9C7,7.896,7.897,7,9,7L9,5.203C8.841,5.115 8.495,5 8,5 7.505,5 7.159,5.115 7,5.203L7,6 5,6 5,5C5,3.841 6.262,3 8,3 9.738,3 11,3.841 11,5z M9,13L7,13 7,11 9,11z M8,1C4.134,1 1,4.134 1,8 1,11.865 4.134,15 8,15 11.866,15 15,11.865 15,8 15,4.134 11.866,1 8,1" />
                                                            <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1M9,11L7,11 7,13 9,13z M9,10L7,10 7,9C7,7.896,7.897,7,9,7L9,5.203C8.841,5.115 8.495,5 8,5 7.505,5 7.159,5.115 7,5.203L7,6 5,6 5,5C5,3.841 6.262,3 8,3 9.738,3 11,3.841 11,5L11,7C11,8.104,10.102,9,9,9z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>

                </Menu>
            </Grid>
     

</Window>

